# Infinite Scroll

Infinite Scroll 은 한 페이지에서 리스트를 추가하면서 출력한다. 다시말해, 페이지 내에서 리스트를 무한대로 출력할 수 있다.

즉, 보여줄 수 있는 리스트 갯수가 많을수록 엘리먼트는 계속해서 증가하게 된다. 이럴경우, DOM 노드 갯수가 계속 증가하게 되고, 메모리도 빠르게 증가하게 된다.

이를 대안하기 위해 보여지는 **DOM 리스트 갯수를 제한하는 방법**을 사용할 수 있다.

DOM 갯수를 제한하는 것은 어렵지 않다.

현재 17번째 리스트를 보여주고 있다면, 이(17)를 기준으로 +- 10개와 같은 방법으로 리스트를 줄일 수 있다.

* 7번 리스트가 화면에 존재한다면, "1번 ~ 17번째 리스트만 보여줘".
* 8번 리스트가 화면에 존재한다면, "1번 ~ 18번째 리스트만 보여줘".
* 17번 리스트가 화면에 존재한다면, "7번 ~ 27번째 리스트만 보여줘".
* 18번 리스트가 화면에 존재한다면, "8번 ~ 28번째 리스트만 보여줘".

문제는, 스크롤을 아래로 내리는 과정에서, 리스트는 계속해서 추가될 것이고, 보여지는 리스트는 항상 20개로 제한된다 - 스크롤의 높이는 20개의 높이를 넘어갈 수가 없게 된다.


총 30 개의 데이터가 있고,

* 현재 `1 ~ 17번째` 리스트가 화면에 보여지고있다면 ::
  > `{ (노출되는 1 ~ 17 번째의 스크롤 높이) + (노출되지 않은 18번 ~ 30번 까지의 높이) }`
* 현재 `17 ~ 30번째` 리스트가 화면에 보여지고있다면 ::  
  > `{ (노출되지 않는 1 ~ 16 번째의 스크롤 높이) + (노출되고있는 17번 ~ 현재 30번 까지의 높이) }`

가 실제 데이터 전체가 차지하는 높이이다.

이를 해결하기 위해 인스타그램은 리스트를 가지고 있는 부모 컨테이너에 `padding` 을 활용했다.

`17 ~ 30 번째`, `1 ~ 16번째` 까지의 리스트에 대한 높이를 `padding-bottom`, `padding-top` 에 할당하여, 스크롤 높이는 유지할 수 있게 된다. (인스타그램의 경우는, `padding-top` 만 사용한다)

``` js
  const ROW_COUNT = 20    // 보여지는 리스트 갯수
  const ROW_HEIGHT = 300  // 하나의 리스트가 차지하는 높이
  const currentStart =  scrollTop / ROW_HEIGHT  // 현재 시작 기준 번호
  const hiddenLastEnd = currentStart - ROW_COUNT / 2   // 제한된 갯수로 인해 상단에 보여지지 않고 있는 영역
  const paddingTop = hiddenLastEnd * ROW_HEIGHT
```

(인스타그램의 경우) 스크롤을 다시 위로 올려서 상위 컨텐츠를 다시 보려고 하는 경우에도 `padding-top` 을 다시 감소시켜줘야합니다.
`padding-bottom` 값을 증가시켜 스크롤 높이를 유지해줘야 한다.

``` js
  현재 실제로 차지하고 있는 높이 = paddingTop + 보여지고 있는 모든 리스트 높이 +  paddingBottom
```

-----------

출처: [마이구미의 HelloWorld](https://mygumi.tistory.com/376)